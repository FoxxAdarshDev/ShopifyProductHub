{% comment %}
  Shopify Product Tab Template - Enhanced Version with YouTube API Integration
  
  This template analyzes the product description HTML content and:
  1. Detects tab content sections by their IDs
  2. Creates corresponding tab navigation
  3. Handles active/inactive tab states
  4. Provides responsive styling with enhanced logo grid and video styling
{% endcomment %}

<!-- YouTube API Script - Load once globally -->
<script src="https://apis.google.com/js/platform.js"></script>
<!-- Include the external script -->
<script src="//www.foxxlifesciences.com/cdn/shop/t/37/assets/modalFunctions.js"></script>

{% assign product_description = product.description %}

{% comment %} Check if product has our template structure {% endcomment %}
{% assign has_container = false %}
{% assign has_tab_structure = false %}
{% assign has_data_sku = false %}

{% if product_description contains 'class="container"' %}
  {% assign has_container = true %}
{% endif %}

{% if product_description contains 'id="description"' or product_description contains 'id="features"' or product_description contains 'id="applications"' %}
  {% assign has_tab_structure = true %}
{% endif %}

{% if product_description contains 'data-sku=' %}
  {% assign has_data_sku = true %}
{% endif %}

{% assign is_template_structure = false %}
{% if has_container and has_tab_structure and has_data_sku %}
  {% assign is_template_structure = true %}
{% endif %}

{% comment %} Only render tabs if we detect our template structure {% endcomment %}
{% if is_template_structure %}

<style>
/* Product Tab Styles */
.halo-product-tabs {
  margin: 20px 0;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
}

.halo-tab-navigation {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 2px;
  margin-bottom: 20px;
  border-bottom: 1px solid #e5e7eb;
  padding-bottom: 0;
  background: #f8fafc;
  border-radius: 8px 8px 0 0;
  padding: 4px;
}

.halo-tab-button {
  background: none;
  border: none;
  padding: 16px 20px; /* Increased padding for better appearance */
  cursor: pointer;
  border-radius: 8px;
  font-size: 18px !important; /* Fixed: Significantly increased font size */
  font-weight: 600 !important; /* Made bolder for better readability */
  color: #374151;
  text-transform: capitalize;
  transition: all 0.3s ease;
  position: relative;
  border-bottom: 2px solid transparent;
  display: flex;
  align-items: center;
  gap: 8px;
  min-height: 52px; /* Increased height for larger buttons */
  letter-spacing: 0.5px; /* Better text spacing */
}

.halo-tab-button:hover {
  color: #374151;
  background-color: #ffffff;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.halo-tab-button.active {
  color: #1f2937;
  background-color: #ffffff;
  border-bottom-color: #3b82f6;
  font-weight: 600;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.halo-tab-icon {
  font-size: 16px;
  opacity: 0.7;
}

.halo-tab-button.active .halo-tab-icon {
  opacity: 1;
}

.halo-tab-content {
  display: block;
  margin-bottom: 40px;
  padding: 24px;
  border: 2px solid transparent;
  border-radius: 12px;
  transition: all 0.3s ease;
  scroll-margin-top: 100px;
}

.halo-tab-content.active {
  border-color: #3b82f6;
  background: #f8fafc;
  box-shadow: 0 4px 12px -2px rgba(59, 130, 246, 0.1);
}

.halo-tab-content-inner {
  line-height: 1.6;
}

.halo-tab-section-title {
  font-size: 24px;
  font-weight: 700;
  color: #1f2937;
  margin-bottom: 20px;
  padding-bottom: 12px;
  border-bottom: 2px solid #e5e7eb;
  display: flex;
  align-items: center;
  gap: 12px;
}

.halo-tab-section-title:before {
  content: "";
  width: 4px;
  height: 28px;
  background: #3b82f6;
  border-radius: 2px;
}

/* Content Styling */
.halo-tab-content h2 {
  font-size: 24px;
  font-weight: 600;
  margin-bottom: 16px;
  color: #1f2937;
}

.halo-tab-content h3 {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 12px;
  color: #374151;
}

.halo-tab-content h4 {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 8px;
  color: #374151;
}

.halo-tab-content p {
  margin-bottom: 16px;
  color: #4b5563;
}

.halo-tab-content ul {
  margin-bottom: 16px;
  padding-left: 20px;
}

.halo-tab-content li {
  margin-bottom: 8px;
  color: #4b5563;
}

.halo-tab-content table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 16px;
}

.halo-tab-content table th,
.halo-tab-content table td {
  padding: 12px;
  text-align: left;
  border-bottom: 1px solid #e5e7eb;
}

.halo-tab-content table th {
  background-color: #f9fafb;
  font-weight: 600;
  color: #374151;
}

/* Fixed: Enhanced Logo Grid Styling - Single Logo Small Box */
.halo-tab-content .logo-grid {
  display: flex !important; /* Changed to flex for better single logo handling */
  flex-wrap: wrap !important;
  justify-content: flex-start !important; /* Fixed: Start alignment instead of full width */
  gap: 20px !important;
  margin: 32px 0 !important;
  padding: 24px !important;
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
  border-radius: 12px !important;
  border: 2px solid #e2e8f0 !important;
  /* Fixed: Removed box shadow as requested */
}

.halo-tab-content .logo-grid img {
  max-height: 80px !important;
  width: auto !important; /* Fixed: Auto width for proper aspect ratio */
  max-width: 150px !important; /* Fixed: Maximum width to prevent full screen */
  min-width: 120px !important; /* Fixed: Minimum width for consistency */
  object-fit: contain !important;
  background: white !important;
  border: 2px solid #cbd5e1 !important;
  border-radius: 8px !important;
  padding: 12px !important;
  display: block !important;
  flex-shrink: 0 !important; /* Fixed: Prevent shrinking */
  transition: all 0.3s ease !important;
  /* Fixed: Removed box shadow as requested */
}

.halo-tab-content .logo-grid img:hover {
  transform: scale(1.05) !important;
  border-color: #3b82f6 !important;
  /* Fixed: Removed box shadow on hover as requested */
}

/* Compatible Container Styling */
.compatible-items-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.compatible-item {
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  padding: 20px;
  transition: all 0.3s ease;
  background: #ffffff;
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
}

.compatible-item:hover {
  box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
  transform: translateY(-2px);
  border-color: #d1d5db;
}

.compatible-item img {
  width: 100%;
  height: 180px;
  object-fit: contain;
  object-position: center;
  border-radius: 8px;
  margin-bottom: 16px;
  background: #f9fafb;
  padding: 10px;
}

.compatible-item-content {
  min-height: 120px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}

.compatible-item-title {
  font-size: 16px;
  font-weight: 600;
  margin-bottom: 12px;
  color: #1f2937;
  line-height: 1.4;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

.compatible-item-description {
  font-size: 14px;
  color: #6b7280;
  margin-bottom: 16px;
  line-height: 1.5;
  flex-grow: 1;
}

.compatible-item-link {
  display: inline-flex;
  align-items: center;
  color: #2563eb;
  text-decoration: none;
  font-weight: 500;
  font-size: 14px;
  padding: 8px 16px;
  border: 1px solid #2563eb;
  border-radius: 6px;
  transition: all 0.2s ease;
  background: transparent;
  text-align: center;
  justify-content: center;
}

.compatible-item-link:hover {
  background: #2563eb;
  color: white;
  text-decoration: none;
  transform: translateY(-1px);
}

/* Documentation Links Styling */
.halo-tab-content #extracted-documentation {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.halo-tab-content #extracted-documentation .documentation-link-card {
  margin: 0;
}

.halo-tab-content #extracted-documentation .documentation-link-card a {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  text-decoration: none;
  transition: all 0.3s ease;
  background: #ffffff;
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
  color: #1f2937;
  font-weight: 500;
  min-height: 60px;
}

.halo-tab-content #extracted-documentation .documentation-link-card a:hover {
  box-shadow: 0 4px 12px -2px rgba(0, 0, 0, 0.1);
  transform: translateY(-1px);
  border-color: #d1d5db;
  background: #f8fafc;
}

.halo-tab-content #extracted-documentation .doc-icon {
  font-size: 20px;
  min-width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: #eff6ff;
  border-radius: 8px;
  border: 1px solid #dbeafe;
  flex-shrink: 0;
}

.halo-tab-content #extracted-documentation .doc-icon.pdf-icon {
  background: #2563eb;
  color: white;
  border-color: #1d4ed8;
}

.halo-tab-content #extracted-documentation .doc-icon.datasheet-icon {
  background: #16a34a;
  color: white;
  border-color: #15803d;
}

.halo-tab-content #extracted-documentation .doc-icon.general-icon {
  background: #eff6ff;
  border-color: #dbeafe;
}

.halo-tab-content #extracted-documentation .doc-content {
  display: flex;
  flex-direction: column;
  gap: 4px;
  flex: 1;
}

.halo-tab-content #extracted-documentation .doc-title {
  font-weight: 600;
  color: #1f2937;
  font-size: 16px;
  line-height: 1.3;
}

.halo-tab-content #extracted-documentation .doc-subtitle {
  font-weight: 400;
  color: #6b7280;
  font-size: 14px;
  line-height: 1.4;
}

/* Fixed: Enhanced Video Styling - 100% Width and Full Height */
.halo-tab-content iframe {
  width: 100% !important; /* Fixed: Full width */
  max-width: 100% !important;
  height: 450px !important; /* Fixed: Increased height for full appearance */
  min-height: 400px !important; /* Fixed: Minimum height for consistency */
  aspect-ratio: 16/9 !important;
  border-radius: 16px !important;
  border: 3px solid #e2e8f0 !important;
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15) !important;
  margin: 20px 0 !important;
  display: block !important;
  transition: all 0.3s ease !important;
}

.halo-tab-content iframe:hover {
  transform: translateY(-2px) !important;
  box-shadow: 0 12px 35px rgba(0, 0, 0, 0.2) !important;
  border-color: #3b82f6 !important;
}

/* Enhanced Video Container - Full Width */
.halo-tab-content #videos {
  width: 100% !important;
  padding: 0 !important;
  margin: 0 !important; /* Fixed: Remove all margins */
}

.halo-tab-content #videos > div {
  width: 100% !important;
  margin: 0 !important; /* Fixed: Remove margins from inner divs */
}

/* Fixed: Ensure video container takes full width */
.halo-tab-content #videos iframe {
  width: 100% !important;
  height: 450px !important; /* Fixed: Full height for videos */
}

/* Mobile responsive */
@media (max-width: 768px) {
  .halo-tab-navigation {
    flex-direction: column;
    position: sticky;
    top: 0;
    background: #f8fafc;
    z-index: 10;
    margin-bottom: 10px;
    padding: 8px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }

  .halo-tab-button {
    text-align: left;
    border-radius: 6px;
    border-bottom: none;
    border-left: 3px solid transparent;
    margin: 2px 0;
    justify-content: flex-start;
  }

  .halo-tab-button.active {
    border-left-color: #3b82f6;
    border-bottom: none;
    background: #ffffff;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
  }

  .halo-tab-content {
    margin-bottom: 20px;
    padding: 16px;
    scroll-margin-top: 120px;
  }

  .halo-tab-section-title {
    font-size: 20px;
    margin-bottom: 16px;
  }

  .compatible-items-grid {
    grid-template-columns: 1fr;
  }

  .halo-tab-content iframe {
    width: 100% !important;
    height: 250px !important;
    border-radius: 12px !important; /* Maintain border radius on mobile */
  }
  
  .halo-tab-button {
    font-size: 16px !important; /* Adjust for mobile but keep readable */
    padding: 14px 18px !important;
  }
  
  .halo-tab-content .logo-grid {
    justify-content: center !important; /* Fixed: Center logos on mobile */
    gap: 16px !important;
    padding: 20px !important;
  }
  
  .halo-tab-content .logo-grid img {
    max-width: 120px !important; /* Fixed: Smaller max width on mobile */
    min-width: 100px !important;
  }
  
  .youtube-brand-header {
    flex-direction: column !important;
    text-align: center !important;
    gap: 12px !important;
  }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Fixed: Compact YouTube Section - Small Box Layout */
.youtube-channel-section {
  margin-top: 24px !important;
  padding: 20px !important; /* Fixed: Reduced padding for compact look */
  border: 2px solid #e2e8f0 !important;
  border-radius: 12px !important; /* Fixed: Smaller border radius */
  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%) !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05) !important; /* Fixed: Subtle shadow */
  width: 100% !important;
  max-width: 600px !important; /* Fixed: Maximum width for compact appearance */
}

.youtube-brand-header {
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  margin-bottom: 16px !important; /* Fixed: Reduced margin */
  flex-wrap: nowrap !important; /* Fixed: Prevent wrapping for compact layout */
  gap: 12px !important; /* Fixed: Smaller gap */
}

.youtube-logo-container {
  display: flex !important;
  align-items: center !important;
  gap: 8px !important; /* Fixed: Smaller gap */
}

.youtube-icon {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 32px !important; /* Fixed: Smaller icon size */
  height: 32px !important;
  border-radius: 6px !important; /* Fixed: Smaller border radius */
  background: #ff0000 !important; /* Fixed: Solid red background */
  color: #ffffff !important;
  font-size: 16px !important; /* Fixed: Smaller font size */
  font-weight: bold !important;
  box-shadow: 0 2px 4px rgba(255, 0, 0, 0.2) !important; /* Fixed: Subtle shadow */
}

.brand-name {
  font-weight: 600 !important; /* Fixed: Less bold */
  font-size: 16px !important; /* Fixed: Smaller font size */
  color: #1f2937 !important;
  white-space: nowrap !important; /* Fixed: Prevent text wrapping */
}

/* Fixed: Compact Subscribe Button - Properly Styled */
.subscribe-button-container {
  display: inline-block !important; /* Fixed: Inline block for compact layout */
  visibility: visible !important;
  opacity: 1 !important;
  min-height: 30px !important; /* Fixed: Smaller height */
  min-width: 90px !important; /* Fixed: Smaller width */
  z-index: 1000 !important;
  flex-shrink: 0 !important; /* Fixed: Prevent shrinking */
}

.g-ytsubscribe {
  display: inline-block !important; /* Fixed: Inline block */
  visibility: visible !important;
  opacity: 1 !important;
  transform: scale(0.9) !important; /* Fixed: Smaller scale for compact look */
  height: 24px !important; /* Fixed: Specific height */
  overflow: hidden !important; /* Fixed: Hide overflow text */
}

/* Fixed: Hide "click this" text in YouTube button */
.g-ytsubscribe div[style*="color"] {
  display: none !important; /* Fixed: Hide the "click this" text */
}

.youtube-description {
  font-size: 14px !important; /* Fixed: Smaller font size */
  color: #4b5563 !important;
  line-height: 1.4 !important; /* Fixed: Tighter line height */
  margin: 0 !important;
  text-align: center !important;
  font-weight: 400 !important; /* Fixed: Normal font weight */
}

.youtube-description a {
  color: #2563eb !important;
  text-decoration: none !important;
  font-weight: 600 !important; /* Fixed: Semi-bold for links */
  border-bottom: 1px solid transparent !important; /* Fixed: Thinner border */
  transition: all 0.2s ease !important; /* Fixed: Faster transition */
}

.youtube-description a:hover {
  border-bottom-color: #2563eb !important;
  color: #1d4ed8 !important;
}
</style>

<div class="halo-product-tabs">
  {% comment %} Tabs will be detected and created dynamically by JavaScript {% endcomment %}

  {% comment %} Tab Navigation - Will be populated dynamically {% endcomment %}
  <div class="halo-tab-navigation">
    <!-- Dynamic tabs will be created here by JavaScript -->
  </div>

  {% comment %} Tab Content - Will be populated dynamically {% endcomment %}
  <div class="halo-tab-content-container">
    {% comment %} Hide original container and extract content directly {% endcomment %}
    <div style="display: none;" id="original-content">{{ product_description }}</div>
    <!-- Dynamic tab content will be created here by JavaScript -->
  </div>

    <script>
    function createDynamicTabs() {
      const originalContent = document.getElementById('original-content');
      if (!originalContent) return;

      const htmlContent = originalContent.innerHTML;

      // Create a temporary div to parse the HTML
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = htmlContent;

      // Find all tab-content divs with IDs and extract available tabs
      const tabElements = tempDiv.querySelectorAll('div[id]');
      const availableTabs = [];
      const tabTitles = {
        'description': 'Description',
        'features': 'Features', 
        'applications': 'Applications',
        'specification': 'Specifications',
        'sterilization-method': 'Sterilization Method',
        'compatible-container': 'Compatible Container',
        'documentation': 'Documentation',
        'videos': 'Videos'
      };

      // Check which tabs actually have content
      tabElements.forEach(function(element) {
        const tabId = element.id;
        if (tabTitles[tabId] && element.innerHTML.trim()) {
          availableTabs.push(tabId);
        }
      });

      // Define tab icons - removed for professional appearance
      const tabIcons = {
        'description': '',
        'features': '', 
        'applications': '',
        'specification': '',
        'sterilization-method': '',
        'compatible-container': '',
        'documentation': '',
        'videos': ''
      };

      // Dynamically create tab navigation
      const tabNavigation = document.querySelector('.halo-tab-navigation');
      if (tabNavigation && availableTabs.length > 0) {
        tabNavigation.innerHTML = '';

        availableTabs.forEach(function(tabId, index) {
          const button = document.createElement('button');
          button.className = 'halo-tab-button' + (index === 0 ? ' active' : '');
          button.setAttribute('onclick', `haloSwitchTab(event, '${tabId}')`);
          button.setAttribute('data-tab', tabId);

          // Add text only (no icons for professional appearance)
          const textSpan = document.createElement('span');
          textSpan.textContent = tabTitles[tabId];

          button.appendChild(textSpan);
          tabNavigation.appendChild(button);
        });
      }

      // Dynamically create tab content containers
      const tabContainer = document.querySelector('.halo-tab-content-container');
      if (tabContainer && availableTabs.length > 0) {
        tabContainer.innerHTML = '<div style="display: none;" id="original-content">' + originalContent.innerHTML + '</div>';

        availableTabs.forEach(function(tabId, index) {
          const tabDiv = document.createElement('div');
          tabDiv.id = 'halo-' + tabId;
          tabDiv.className = 'halo-tab-content' + (index === 0 ? ' active' : '');

          const innerDiv = document.createElement('div');
          innerDiv.className = 'halo-tab-content-inner';

          // Add section title
          const titleDiv = document.createElement('h3');
          titleDiv.className = 'halo-tab-section-title';
          titleDiv.textContent = tabTitles[tabId];

          const extractedDiv = document.createElement('div');
          extractedDiv.id = 'extracted-' + tabId;

          innerDiv.appendChild(titleDiv);
          innerDiv.appendChild(extractedDiv);
          tabDiv.appendChild(innerDiv);
          tabContainer.appendChild(tabDiv);
        });
      }

      // Clean up
      tempDiv.remove();
    }

    function extractTabContent() {
      const originalContent = document.getElementById('original-content');
      if (!originalContent) return;

      const htmlContent = originalContent.innerHTML;

      // Create a temporary div to parse the HTML
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = htmlContent;

      // Find all tab-content divs with IDs
      const tabElements = tempDiv.querySelectorAll('div[id]');

      tabElements.forEach(function(element) {
        const tabId = element.id;
        const extractedElement = document.getElementById('extracted-' + tabId);

        if (extractedElement) {
          // Clone the inner content without the wrapper div
          const content = element.innerHTML;
          extractedElement.innerHTML = content;
        }
      });

      // Clean up
      tempDiv.remove();
    }

    function haloSwitchTab(event, tabId) {
      // Remove active class from all tab buttons
      var tabButtons = document.querySelectorAll('.halo-tab-button');
      tabButtons.forEach(function(button) {
        button.classList.remove('active');
      });

      // Add active class to clicked button
      event.target.classList.add('active');

      // Remove active class from all tab content
      var tabContents = document.querySelectorAll('.halo-tab-content');
      tabContents.forEach(function(content) {
        content.classList.remove('active');
      });

      // Find and scroll to the selected tab content
      var activeTab = document.getElementById('halo-' + tabId);
      if (activeTab) {
        // Add active class for highlighting
        activeTab.classList.add('active');

        // Smooth scroll to the section
        activeTab.scrollIntoView({ 
          behavior: 'smooth', 
          block: 'start',
          inline: 'nearest' 
        });
      }
    }

    // Add scroll spy functionality to highlight active section
    function setupScrollSpy() {
      const tabContents = document.querySelectorAll('.halo-tab-content');
      const tabButtons = document.querySelectorAll('.halo-tab-button');

      if (tabContents.length === 0 || tabButtons.length === 0) return;

      const observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(entry) {
          if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
            const tabId = entry.target.id.replace('halo-', '');

            // Remove active from all buttons and content
            tabButtons.forEach(function(btn) { btn.classList.remove('active'); });
            tabContents.forEach(function(content) { content.classList.remove('active'); });

            // Add active to current section and button
            entry.target.classList.add('active');
            const activeButton = document.querySelector(`[data-tab="${tabId}"]`);
            if (activeButton) {
              activeButton.classList.add('active');
            }
          }
        });
      }, { 
        threshold: [0.5],
        rootMargin: '-20% 0px -20% 0px'
      });

      tabContents.forEach(function(content) {
        observer.observe(content);
      });
    }

    // Initialize tabs on page load
    document.addEventListener('DOMContentLoaded', function() {
      // Create dynamic tabs first
      createDynamicTabs();

      // Then extract content
      extractTabContent();

      // Setup scroll spy to highlight active sections
      setTimeout(function() {
        setupScrollSpy();

        // Ensure first tab is active by default
        var firstButton = document.querySelector('.halo-tab-button');
        var firstContent = document.querySelector('.halo-tab-content');

        if (firstButton && firstContent) {
          firstButton.classList.add('active');
          firstContent.classList.add('active');
        }
      }, 100);
    });
    </script>

</div>

<!-- YouTube API Script - Load once globally -->
<script src="https://apis.google.com/js/platform.js"></script>
<!-- Include the external script -->
<script src="//www.foxxlifesciences.com/cdn/shop/t/37/assets/modalFunctions.js"></script>

{% else %}
  {% comment %} Fallback: Show original product description if no template structure detected {% endcomment %}
  <div class="product-description-fallback">
    {{ product.description }}
  </div>
{% endif %}